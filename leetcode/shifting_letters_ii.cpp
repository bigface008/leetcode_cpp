//
// https://leetcode.com/problems/shifting-letters-ii/?envType=daily-question&envId=2025-01-05
//

#include "leetcode_utils.hpp"

using namespace std;

class Solution {
public:
    string shiftingLetters(string s, vector<vector<int>> &shifts) {
        const int N = s.size();
        vector<int> diff(N + 1, 0);
        diff[0] = s[0] - 'a';
        for (int i = 1; i < N; i++) {
            diff[i] = s[i] - s[i - 1];
        }
        for (auto &shift : shifts) {
            int start = shift[0];
            int end = shift[1];
            int direction = shift[2];
            if (direction == 1) {
                diff[start] += 1;
                diff[end + 1] -= 1;
            } else {
                diff[start] -= 1;
                diff[end + 1] += 1;
            }
        }
        vector<int> ans(N, 0);
        //        string ans(N, 0);
//        ans[0] = (diff[0] + 26) % 26;
//        for (int i = 1; i < N; i++) {
//            ans[i] = (ans[i - 1] + diff[i] + 26) % 26;
//        }
        ans[0] = diff[0];
        for (int i = 1; i < N; i++) {
            ans[i] = ans[i - 1] + diff[i];
        }
        string str(N, 0);
        for (int i = 0; i < N; i++) {
//            str[i] = ans[i] + 'a';
            str[i] = ((ans[i] % 26) + 26) % 26 + 'a';
//            str[i] = 'a' +
        }
        return str;
    }
};


int main() {
    auto f = [](string s, vector<vector<int>> &&shifts, string expect) {
        auto output = Solution().shiftingLetters(s, shifts);
        leetcode_assert(output == expect, "shifting_letters_ii s={} shifts={} expect={} output={}", s, shifts, expect,
                        output);
    };
    f("alxgnbuqzmlnxcyzhqfznompymigmilhgrliubnlaycjprioczvqgbrpbwxnbqrnmdoskwiimkzltgdomvzhpbufuscueamjynynvbtulmcbntls"
      "ojbyjcvaagmpccdsapdghwoblibwlqrd",
      make2DIntVecByStr(
          "[[28,94,1],[103,132,1],[34,126,0],[24,97,0],[51,68,0],[54,73,0],[122,133,1],[53,106,1],[123,136,0],[108,111,"
          "0],[15,71,1],[16,108,0],[96,122,0],[39,44,0],[136,138,1],[63,133,0],[115,115,1],[80,106,1],[141,141,1],[122,"
          "123,0],[123,138,0],[6,15,1],[115,116,0],[98,132,0],[95,105,1],[70,121,0],[108,133,1],[127,142,0],[101,140,0]"
          ",[117,140,1],[70,116,0],[50,91,0],[7,43,0],[92,133,0],[51,127,0],[74,102,1],[113,127,1],[138,141,0],[37,140,"
          "0],[86,130,1],[24,40,1],[42,45,0],[107,140,0],[108,133,1],[80,83,0],[69,102,1],[139,139,1],[18,126,0],[7,46,"
          "1],[107,133,0],[131,135,0],[31,96,1],[124,141,0],[106,106,1],[51,105,0],[116,125,0],[79,86,1],[139,142,0],["
          "58,81,1],[61,70,0],[73,131,1],[7,119,0],[125,136,1],[41,64,1],[16,117,0],[129,143,0],[90,103,0],[120,134,0],"
          "[81,114,0],[4,76,1],[92,124,1],[70,135,0],[90,118,0],[44,131,0],[108,139,1],[55,124,0],[53,94,0],[117,132,1]"
          ",[91,141,1],[56,113,0],[83,120,0],[100,106,1],[56,97,0],[140,141,0],[98,105,1],[16,118,0],[4,120,0],[67,85,"
          "0],[108,119,0],[96,120,1],[43,126,1],[55,91,1],[122,127,0],[11,74,1],[8,113,1],[82,118,1],[122,134,0],[8,72,"
          "0],[99,138,0],[41,92,0],[126,137,0],[64,73,0],[120,137,1],[137,138,1],[57,99,1],[141,141,1],[113,141,1],[63,"
          "119,1],[38,117,0],[49,63,0],[52,57,0],[121,121,0],[83,85,1],[137,141,0],[103,110,1],[40,45,0],[8,85,1],[34,"
          "43,1],[115,132,1],[124,124,1],[99,118,1],[40,54,0],[21,43,0],[99,123,0],[26,74,1],[127,132,0],[72,86,0],["
          "119,123,1],[69,141,0],[41,58,0],[113,124,1],[132,138,1],[19,56,1],[69,86,0],[130,133,0],[131,134,1],[129,"
          "143,0],[21,34,1],[55,68,1],[126,141,1],[120,129,0],[81,99,0],[50,118,1],[67,119,1],[98,104,1],[84,113,1],["
          "51,113,0],[20,60,0],[77,136,0],[2,16,1],[8,69,1],[0,59,1],[41,127,0],[53,87,1],[31,62,0],[133,137,1],[101,"
          "140,0],[41,67,0],[131,135,0],[21,134,0],[92,135,1],[120,136,0],[126,133,0],[108,123,1],[108,112,0],[140,142,"
          "1],[107,121,0],[101,139,1],[68,137,1],[110,124,1],[94,98,0],[14,18,0],[112,127,1],[116,137,1],[141,142,1],["
          "91,102,1],[106,118,1],[139,142,1],[56,60,0],[22,65,0],[110,114,0],[22,83,1],[126,138,0],[106,123,1],[95,122,"
          "0],[111,134,1],[127,128,0],[19,34,0],[39,114,0],[111,111,0],[18,138,0],[12,121,1],[34,141,1],[59,139,1],[40,"
          "52,0],[131,133,1],[92,124,1],[96,139,1],[42,45,1],[73,88,1],[61,97,0],[41,60,0],[50,113,1],[17,120,1],[129,"
          "134,1],[94,99,1],[72,124,0],[97,132,0],[122,134,0],[3,64,1],[47,123,1],[103,111,0],[56,110,0],[111,124,1],["
          "82,121,0],[9,84,0],[65,126,1],[32,75,0],[104,109,1],[19,84,0],[117,141,1],[18,84,0],[33,73,0],[21,121,0],["
          "54,121,0],[106,108,1],[143,143,0],[119,134,0],[46,137,1],[90,124,0],[8,16,1],[97,140,1],[67,91,1],[133,141,"
          "0],[103,135,0],[9,65,0],[58,115,1],[139,141,1],[50,133,0],[47,61,1],[76,130,0],[92,110,1],[83,138,1],[46,"
          "135,1],[48,122,0],[29,127,1],[60,115,0],[73,87,0],[71,141,0],[107,137,0],[93,116,1],[103,125,1],[5,55,1],["
          "33,135,1],[43,44,0],[98,99,0],[28,139,0],[52,72,0],[131,134,0],[47,96,0],[89,102,1],[92,117,1],[133,133,0],["
          "131,132,0],[102,141,1],[23,129,0],[5,27,1],[124,141,0],[52,129,0],[58,72,0],[10,127,1],[97,110,1],[126,127,"
          "1],[33,82,1],[104,110,0],[47,96,0],[42,107,1],[96,99,1],[91,141,0],[0,27,0],[28,49,0],[1,110,1],[40,112,1],["
          "24,130,0],[64,132,0],[125,135,0],[50,95,1],[15,44,1],[79,125,0],[47,92,1],[94,108,0],[72,117,0],[63,105,0],["
          "76,107,1],[91,135,1],[70,74,0],[45,115,1],[63,143,1],[138,139,0],[13,110,1],[3,61,1],[117,142,0],[14,25,0],["
          "61,112,0],[111,114,1],[23,55,0],[58,125,1],[0,129,0],[137,139,0],[63,135,0],[128,139,0],[1,33,0],[71,121,0],"
          "[125,127,1],[54,101,1],[137,141,0],[1,109,1],[28,29,1],[48,63,0],[81,105,1],[125,141,1],[118,131,0],[84,127,"
          "0],[133,133,1],[84,92,0],[16,102,1],[132,139,0],[142,142,0],[25,62,1],[135,142,1],[64,105,1],[104,117,1],[1,"
          "60,0],[16,56,1],[41,142,0],[29,52,0],[115,126,1],[122,139,1],[67,99,1],[8,34,0],[7,86,1],[135,140,1],[102,"
          "127,1],[15,72,0],[125,132,0],[15,121,1],[125,142,1],[70,78,0],[111,130,0],[67,139,1],[142,142,0],[80,121,1],"
          "[70,81,1],[113,139,1],[69,142,1],[60,116,1],[143,143,1],[63,97,0],[94,138,0],[101,116,1],[47,113,0],[81,141,"
          "0],[25,139,1],[5,106,1],[61,115,1],[38,38,1],[5,119,0],[94,131,0],[120,128,1],[24,116,1],[16,75,1],[69,107,"
          "1],[135,142,1],[108,143,1],[121,124,0],[4,66,0],[137,142,1],[111,139,0],[86,111,1],[92,121,0],[20,97,1],[11,"
          "23,1],[108,140,1],[129,131,1],[59,131,0],[45,46,0],[67,134,1],[133,143,1],[2,42,0],[0,103,0],[125,129,1],[9,"
          "125,1],[107,116,0],[97,110,0],[14,109,0],[21,53,0],[105,114,1],[87,103,0],[0,133,0],[22,86,1],[121,135,0],["
          "70,142,1],[121,124,0],[127,129,0],[100,141,0],[43,86,0],[123,128,1],[115,131,1],[9,133,1],[25,47,1],[19,62,"
          "1],[120,141,1],[91,138,0],[69,98,0],[1,81,1],[121,125,1],[66,94,1],[124,126,1],[54,88,1],[51,90,0],[139,142,"
          "1],[57,96,1],[99,133,1],[80,98,0],[62,93,0],[85,133,0],[51,76,1],[118,126,1],[77,96,1],[9,124,1],[63,108,0],"
          "[114,125,0],[88,126,1],[45,61,1],[61,81,0],[45,108,1],[99,115,1],[74,77,0],[48,52,0],[138,138,1],[79,89,1],["
          "71,134,0],[21,108,1],[115,126,1],[139,139,1],[5,38,1],[118,128,0],[25,131,0],[69,94,0],[98,116,1],[60,101,1]"
          ",[97,126,0],[52,88,0],[97,140,0],[89,139,1],[38,74,1],[15,130,1],[50,137,1],[71,93,0],[82,125,1],[136,137,1]"
          ",[100,102,0],[89,124,0],[139,140,1],[122,134,1],[38,41,0],[7,114,1],[88,107,1],[83,114,1],[35,79,1],[56,121,"
          "1],[58,62,0],[53,111,0],[10,30,1],[0,3,0],[58,91,1],[101,102,1],[40,81,1],[88,132,0],[106,106,0],[53,135,0],"
          "[40,43,0],[109,111,1],[8,99,0],[68,75,0],[71,86,0],[79,140,1],[88,98,0],[3,6,0],[113,125,1],[142,142,1],["
          "139,142,0],[82,118,1],[91,107,1],[17,107,1],[29,128,1],[74,113,1],[29,91,0],[86,128,0],[77,139,0],[19,115,1]"
          ",[85,136,0],[139,140,0],[93,98,0],[81,84,0],[39,63,0],[30,73,0],[5,110,1],[108,133,1],[107,116,0],[27,138,1]"
          ",[27,106,0]]"),
      "wiueldxvftuyjpimtcokyxwxfvtrxtupnzvugmyrewcjqvpvfbardarravzqeurklbpyrckggjdnwgespvyhocvgvtzugdolbncxdkczuvmcmtko"
      "noeekexzadmrcebimbsuxrkcsrecnvwe");
}
